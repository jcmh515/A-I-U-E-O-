<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <title>äº”åéŸ³ åå°„ç¥ç¶“è¨“ç·´å™¨ (å®Œå…¨é«”)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; padding: 30px; background-color: #f4f7f6; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        /* æ§åˆ¶é¢æ¿æ’ç‰ˆ */
        .controls { margin-bottom: 20px; background: #f9f9f9; padding: 20px; border-radius: 10px; }
        .checkbox-group { margin-bottom: 20px; font-size: 16px; font-weight: bold; color: #34495e; text-align: center; }
        
        /* é›™æ’ç¶²æ ¼è¨­è¨ˆï¼Œç­‰10å€‹é¸é …æ’å¾—éšå•² */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            max-width: 500px;
            margin: 15px auto 0;
            text-align: left;
        }
        .grid-container label { cursor: pointer; display: flex; align-items: center; font-size: 17px; }
        .grid-container input { transform: scale(1.3); margin-right: 10px; cursor: pointer; }
        
        select, button { font-size: 18px; padding: 10px 20px; margin: 5px; cursor: pointer; border-radius: 8px; border: none; font-weight: bold; transition: 0.2s; }
        select { border: 1px solid #ccc; background: white; }
        
        #start-btn { background-color: #4CAF50; color: white; box-shadow: 0 4px #388E3C; }
        #start-btn:active { transform: translateY(4px); box-shadow: 0 0 #388E3C; }
        #start-btn.running { background-color: #f44336; box-shadow: 0 4px #d32f2f; }
        
        #speaker-btn { background-color: #2196F3; color: white; box-shadow: 0 4px #1976D2; }
        #speaker-btn:disabled { background-color: #cccccc; color: #666; box-shadow: none; cursor: not-allowed; }
        
        #timer-display { font-size: 28px; color: #e67e22; margin-top: 15px; font-weight: bold; }

        /* é¡¯ç¤ºå€æ’ç‰ˆ */
        #display-area { 
            display: flex; 
            justify-content: center; 
            flex-wrap: wrap; 
            gap: 15px; 
            margin: 30px 0; 
            min-height: 120px; 
        }
        .kana-box { display: flex; flex-direction: column; align-items: center; }
        .kana { font-size: 60px; font-weight: bold; color: #2c3e50; }
        .romaji { font-size: 24px; color: #e74c3c; font-weight: bold; margin-top: 5px; }
        .hidden { visibility: hidden; }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸ¯ äº”åéŸ³ åå°„ç¥ç¶“è¨“ç·´å™¨ (å®Œå…¨é«”)</h2>
        
        <div class="controls">
            <div class="checkbox-group">
                <span style="font-size: 20px;">ğŸ“š é¸æ“‡æº«ç¿’ç¯„åœ (å¯å¤šé¸)ï¼š</span>
                <div class="grid-container">
                    <label><input type="checkbox" id="row-a" value="a" checked> ã‚è¡Œ (a, i, u, e, o)</label>
                    <label><input type="checkbox" id="row-k" value="k"> ã‹è¡Œ (ka, ki, ku, ke, ko)</label>
                    <label><input type="checkbox" id="row-s" value="s"> ã•è¡Œ (sa, shi, su, se, so)</label>
                    <label><input type="checkbox" id="row-t" value="t"> ãŸè¡Œ (ta, chi, tsu, te, to)</label>
                    <label><input type="checkbox" id="row-n" value="n"> ãªè¡Œ (na, ni, nu, ne, no)</label>
                    <label><input type="checkbox" id="row-h" value="h"> ã¯è¡Œ (ha, hi, fu, he, ho)</label>
                    <label><input type="checkbox" id="row-m" value="m"> ã¾è¡Œ (ma, mi, mu, me, mo)</label>
                    <label><input type="checkbox" id="row-y" value="y"> ã‚„è¡Œ (ya, yu, yo)</label>
                    <label><input type="checkbox" id="row-r" value="r"> ã‚‰è¡Œ (ra, ri, ru, re, ro)</label>
                    <label><input type="checkbox" id="row-w" value="w"> ã‚è¡Œ/ã‚“ (wa, wo, n)</label>
                </div>
            </div>

            <label for="char-count" style="font-size: 18px; font-weight: bold; color: #34495e;">ğŸ² é¸æ“‡æŠ½è€ƒå­—æ•¸ï¼š</label>
            <select id="char-count">
                <option value="3">3 å€‹éŸ³</option>
                <option value="5" selected>5 å€‹éŸ³</option>
                <option value="7">7 å€‹éŸ³</option>
                <option value="10">10 å€‹éŸ³ (åœ°ç„ç´š)</option>
                <option value="15">15 å€‹éŸ³ (ç¥ç´š)</option>
            </select>
        </div>
        
        <div id="display-area">
            <div style="font-size: 30px; color: #95a5a6; margin-top: 30px;">è«‹æ’³ã€Œé–‹å§‹æ¸¬è©¦ã€</div>
        </div>
        
        <button id="start-btn">â–¶ï¸ é–‹å§‹æ¸¬è©¦</button>
        <button id="speaker-btn" disabled>ğŸ”Š è½ Google æ­£ç¢ºç™¼éŸ³</button>
        
        <div id="timer-display">æ™‚é–“: 0.00 ç§’</div>
    </div>

    <script>
        // çµ‚æ¥µå¤§å­—å…¸ï¼šåŒ…å«æ™’æ‰€æœ‰å¹³å‡å
        const kanaMap = {
            'a': [{kana: 'ã‚', romaji: 'a'}, {kana: 'ã„', romaji: 'i'}, {kana: 'ã†', romaji: 'u'}, {kana: 'ãˆ', romaji: 'e'}, {kana: 'ãŠ', romaji: 'o'}],
            'k': [{kana: 'ã‹', romaji: 'ka'}, {kana: 'ã', romaji: 'ki'}, {kana: 'ã', romaji: 'ku'}, {kana: 'ã‘', romaji: 'ke'}, {kana: 'ã“', romaji: 'ko'}],
            's': [{kana: 'ã•', romaji: 'sa'}, {kana: 'ã—', romaji: 'shi'}, {kana: 'ã™', romaji: 'su'}, {kana: 'ã›', romaji: 'se'}, {kana: 'ã', romaji: 'so'}],
            't': [{kana: 'ãŸ', romaji: 'ta'}, {kana: 'ã¡', romaji: 'chi'}, {kana: 'ã¤', romaji: 'tsu'}, {kana: 'ã¦', romaji: 'te'}, {kana: 'ã¨', romaji: 'to'}],
            'n': [{kana: 'ãª', romaji: 'na'}, {kana: 'ã«', romaji: 'ni'}, {kana: 'ã¬', romaji: 'nu'}, {kana: 'ã­', romaji: 'ne'}, {kana: 'ã®', romaji: 'no'}],
            'h': [{kana: 'ã¯', romaji: 'ha'}, {kana: 'ã²', romaji: 'hi'}, {kana: 'ãµ', romaji: 'fu'}, {kana: 'ã¸', romaji: 'he'}, {kana: 'ã»', romaji: 'ho'}],
            'm': [{kana: 'ã¾', romaji: 'ma'}, {kana: 'ã¿', romaji: 'mi'}, {kana: 'ã‚€', romaji: 'mu'}, {kana: 'ã‚', romaji: 'me'}, {kana: 'ã‚‚', romaji: 'mo'}],
            'y': [{kana: 'ã‚„', romaji: 'ya'}, {kana: 'ã‚†', romaji: 'yu'}, {kana: 'ã‚ˆ', romaji: 'yo'}],
            'r': [{kana: 'ã‚‰', romaji: 'ra'}, {kana: 'ã‚Š', romaji: 'ri'}, {kana: 'ã‚‹', romaji: 'ru'}, {kana: 'ã‚Œ', romaji: 're'}, {kana: 'ã‚', romaji: 'ro'}],
            'w': [{kana: 'ã‚', romaji: 'wa'}, {kana: 'ã‚’', romaji: 'wo'}, {kana: 'ã‚“', romaji: 'n'}]
        };

        const rows = ['a', 'k', 's', 't', 'n', 'h', 'm', 'y', 'r', 'w'];
        let isRunning = false;
        let startTime;
        let timerInterval;
        let currentRawText = '';

        const displayArea = document.getElementById('display-area');
        const startBtn = document.getElementById('start-btn');
        const speakerBtn = document.getElementById('speaker-btn');
        const timerDisplay = document.getElementById('timer-display');
        const charCountSelect = document.getElementById('char-count');

        // è‡ªå‹•æª¢æŸ¥ç”¨å®¶å‰”å’—é‚Šå¹¾è¡Œ
        function getSelectedPool() {
            let pool = [];
            rows.forEach(row => {
                if (document.getElementById('row-' + row).checked) {
                    pool = pool.concat(kanaMap[row]);
                }
            });
            
            // é˜²å‘†æ©Ÿåˆ¶ï¼šå¦‚æœå’©éƒ½ç„¡å‰”ï¼Œè‡ªå‹•å‰”è¿”ã‚è¡Œç•€ä½¢
            if (pool.length === 0) {
                document.getElementById('row-a').checked = true;
                pool = kanaMap['a'];
            }
            return pool;
        }

        function generateDisplay(length) {
            const pool = getSelectedPool();
            let html = '';
            currentRawText = ''; 
            
            for (let i = 0; i < length; i++) {
                const randomObj = pool[Math.floor(Math.random() * pool.length)];
                currentRawText += randomObj.kana;
                html += `
                    <div class="kana-box">
                        <div class="kana">${randomObj.kana}</div>
                        <div class="romaji hidden">${randomObj.romaji}</div>
                    </div>
                `;
            }
            displayArea.innerHTML = html;
        }

        function updateTimer() {
            const currentTime = new Date().getTime();
            const elapsedTime = (currentTime - startTime) / 1000;
            timerDisplay.textContent = `æ™‚é–“: ${elapsedTime.toFixed(2)} ç§’`;
        }

        startBtn.addEventListener('click', () => {
            if (!isRunning) {
                isRunning = true;
                startBtn.textContent = 'â¹ï¸ è®€å®Œï¼(åœæ­¢è¨ˆæ™‚)';
                startBtn.classList.add('running');
                speakerBtn.disabled = true; 
                timerDisplay.style.color = '#333';
                
                const length = parseInt(charCountSelect.value);
                generateDisplay(length); 
                
                startTime = new Date().getTime();
                timerInterval = setInterval(updateTimer, 50); 
            } else {
                isRunning = false;
                clearInterval(timerInterval);
                startBtn.textContent = 'ğŸ”„ å†åšŸä¸€æ¬¡ (é–‹å§‹)';
                startBtn.classList.remove('running');
                speakerBtn.disabled = false; 
                timerDisplay.style.color = '#e67e22'; 
                
                const romajiElements = document.querySelectorAll('.romaji');
                romajiElements.forEach(el => el.classList.remove('hidden'));
            }
        });

        speakerBtn.addEventListener('click', () => {
            if (currentRawText) {
                const spacedText = currentRawText.split('').join(', ');
                const utterance = new SpeechSynthesisUtterance(spacedText);
                utterance.lang = 'ja-JP'; 
                utterance.rate = 0.75; 
                window.speechSynthesis.speak(utterance);
            }
        });
    </script>
</body>
</html>
